describe("paging factory",function(){var e,t,a,n;beforeEach(module("ui.bootstrap.paging")),beforeEach(inject(function(o,l){e=o,t=e.$new(),a={},n={},l.create(a,t,n)})),describe("init",function(){var o,l;beforeEach(function(){o={},l={foo:"bar",itemsPerPage:12}}),describe("without itemsPerPage",function(){beforeEach(function(){a.init(o,l)}),it("should set the ngModel and config",function(){expect(a.ngModelCtrl).toBe(o),expect(a.config).toBe(l)}),it("should properly render the model",function(){spyOn(a,"render"),o.$render(),expect(a.render).toHaveBeenCalled()}),it("should set to default itemsPerPage",function(){expect(a.itemsPerPage).toBe(12)}),it("should update the page when total items changes",function(){spyOn(a,"calculateTotalPages").and.returnValue(5),spyOn(a,"updatePage"),e.$digest(),expect(a.calculateTotalPages.calls.count()).toBe(0),expect(a.updatePage.calls.count()).toBe(0),t.totalItems=10,e.$digest(),expect(a.calculateTotalPages.calls.count()).toBe(1),expect(a.updatePage.calls.count()).toBe(1),expect(t.totalPages).toBe(5),t.totalItems=void 0,t.totalPages=2,e.$digest(),expect(a.calculateTotalPages.calls.count()).toBe(2),expect(a.updatePage.calls.count()).toBe(2),expect(t.totalPages).toBe(5)})}),describe("with itemsPerPage",function(){beforeEach(function(){n.itemsPerPage="abc",e.abc=10,a.init(o,l)}),it("should update the page when itemsPerPage changes",function(){spyOn(a,"calculateTotalPages").and.returnValue(5),spyOn(a,"updatePage"),e.$digest(),expect(a.itemsPerPage).toBe(10),expect(t.totalPages).toBe(5),expect(a.updatePage).toHaveBeenCalled()})})}),describe("calculate totalPages",function(){it("when itemsPerPage is less than 1",function(){a.itemsPerPage=0,t.totalItems=101,expect(a.calculateTotalPages()).toBe(1)}),it("when itemsPerPage is greater than 1",function(){a.itemsPerPage=10,t.totalItems=101,expect(a.calculateTotalPages()).toBe(11)})}),describe("render",function(){it("should set page to 1 when invalid",function(){a.ngModelCtrl.$viewValue="abcd",t.page=10,a.render(),expect(t.page).toBe(1)}),it("should set page to view value when valid",function(){a.ngModelCtrl.$viewValue="3",t.page=10,a.render(),expect(t.page).toBe(3)})}),describe("select page",function(){beforeEach(function(){spyOn(a.ngModelCtrl,"$setViewValue"),a.ngModelCtrl.$render=jasmine.createSpy("ctrl.ngModelCtrl.$render"),t.page=5,t.totalPages=20}),it("should change the page",function(){t.selectPage(12),expect(a.ngModelCtrl.$setViewValue).toHaveBeenCalledWith(12),expect(a.ngModelCtrl.$render).toHaveBeenCalled()}),it("should not change the page to one out of range",function(){t.selectPage(-1),expect(a.ngModelCtrl.$setViewValue).not.toHaveBeenCalled(),expect(a.ngModelCtrl.$render).not.toHaveBeenCalled(),t.selectPage(21),expect(a.ngModelCtrl.$setViewValue).not.toHaveBeenCalled(),expect(a.ngModelCtrl.$render).not.toHaveBeenCalled()}),describe("on click",function(){var e;beforeEach(function(){e={preventDefault:jasmine.createSpy("evt.preventDefault"),target:{blur:jasmine.createSpy("evt.target.blur")}}}),it("should prevent default behavior",function(){t.selectPage(12,e),expect(e.preventDefault).toHaveBeenCalled()}),it("should not change the page if disabled and from an event",function(){t.ngDisabled=!0,t.selectPage(12,e),expect(a.ngModelCtrl.$setViewValue).not.toHaveBeenCalled(),expect(a.ngModelCtrl.$render).not.toHaveBeenCalled()}),it("should blur the element clicked",function(){t.selectPage(12,e),expect(e.target.blur).toHaveBeenCalled()})})}),it("should get the text",function(){t.fooText="bar",expect(t.getText("foo")).toBe("bar")}),it("should get the default text",function(){a.config={fooText:"bar"},expect(t.getText("foo")).toBe("bar")}),it("should disable previous button",function(){t.page=1,expect(t.noPrevious()).toBe(!0)}),it("should enable previous button",function(){t.page=2,expect(t.noPrevious()).toBe(!1)}),it("should disable next button",function(){t.page=10,t.totalPages=10,expect(t.noNext()).toBe(!0)}),it("should enable next button",function(){t.page=9,t.totalPages=10,expect(t.noNext()).toBe(!1)}),describe("update page",function(){beforeEach(function(){spyOn(t,"selectPage"),a.ngModelCtrl.$render=jasmine.createSpy("ctrl.ngModelCtrl.$render"),a.setNumPages=jasmine.createSpy("ctrl.setNumPages"),t.totalPages=10}),it("should select the last page if page is above total",function(){t.page=12,a.updatePage(),expect(a.setNumPages).toHaveBeenCalledWith(e,10),expect(t.selectPage).toHaveBeenCalledWith(10),expect(a.ngModelCtrl.$render).not.toHaveBeenCalled()}),it("should execute render if page is within range",function(){t.page=5,a.updatePage(),expect(a.setNumPages).toHaveBeenCalledWith(e,10),expect(t.selectPage).not.toHaveBeenCalled(),expect(a.ngModelCtrl.$render).toHaveBeenCalled()})}),describe("gc",function(){it("should clear watchers",function(){var e=jasmine.createSpy("watcher1"),n=jasmine.createSpy("watcher2");a._watchers=[e,n],t.$destroy(),expect(a._watchers.length).toBe(0),expect(e).toHaveBeenCalled(),expect(n).toHaveBeenCalled()})})});
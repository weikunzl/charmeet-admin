angular.module("ui.bootstrap.typeahead",["ui.bootstrap.debounce","ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(a){var n=a.match(t);if(!n)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+a+'".');return{itemName:n[3],source:e(n[4]),viewMapper:e(n[2]||n[1]),modelMapper:e(n[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$$debounce","$uibPosition","uibTypeaheadParser",function(e,t,a,n,i,o,r,c,l,s,p,d,u){function h(){j.moveInProgress||(j.moveInProgress=!0,j.$digest()),Q()}function v(){j.position=S?d.offset(t):d.position(t),j.position.top+=t.prop("offsetHeight")}var f,m,g=[9,13,27,38,40],$=200,b=e.$eval(a.typeaheadMinLength);b||0===b||(b=1),e.$watch(a.typeaheadMinLength,function(e){b=e||0===e?e:1});var y=e.$eval(a.typeaheadWaitMs)||0,x=e.$eval(a.typeaheadEditable)!==!1;e.$watch(a.typeaheadEditable,function(e){x=e!==!1});var w,I,U=i(a.typeaheadLoading).assign||angular.noop,T=i(a.typeaheadOnSelect),O=angular.isDefined(a.typeaheadSelectOnBlur)?e.$eval(a.typeaheadSelectOnBlur):!1,M=i(a.typeaheadNoResults).assign||angular.noop,N=a.typeaheadInputFormatter?i(a.typeaheadInputFormatter):void 0,S=a.typeaheadAppendToBody?e.$eval(a.typeaheadAppendToBody):!1,P=a.typeaheadAppendTo?e.$eval(a.typeaheadAppendTo):null,V=e.$eval(a.typeaheadFocusFirst)!==!1,k=a.typeaheadSelectOnExact?e.$eval(a.typeaheadSelectOnExact):!1,q=i(a.typeaheadIsOpen).assign||angular.noop,A=e.$eval(a.typeaheadShowHint)||!1,_=i(a.ngModel),E=i(a.ngModel+"($$$p)"),C=function(t,a){return angular.isFunction(_(e))&&m&&m.$options&&m.$options.getterSetter?E(t,{$$$p:a}):_.assign(t,a)},F=u.parse(a.uibTypeahead),j=e.$new(),z=e.$on("$destroy",function(){j.$destroy()});j.$on("$destroy",z);var B="typeahead-"+j.$id+"-"+Math.floor(1e4*Math.random());t.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":B});var D,H;A&&(D=angular.element("<div></div>"),D.css("position","relative"),t.after(D),H=t.clone(),H.attr("placeholder",""),H.attr("tabindex","-1"),H.val(""),H.css({position:"absolute",top:"0px",left:"0px","border-color":"transparent","box-shadow":"none",opacity:1,background:"none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255)",color:"#999"}),t.css({position:"relative","vertical-align":"top","background-color":"transparent"}),D.append(H),H.after(t));var L=angular.element("<div uib-typeahead-popup></div>");L.attr({id:B,matches:"matches",active:"activeIdx",select:"select(activeIdx, evt)","move-in-progress":"moveInProgress",query:"query",position:"position","assign-is-open":"assignIsOpen(isOpen)",debounce:"debounceUpdate"}),angular.isDefined(a.typeaheadTemplateUrl)&&L.attr("template-url",a.typeaheadTemplateUrl),angular.isDefined(a.typeaheadPopupTemplateUrl)&&L.attr("popup-template-url",a.typeaheadPopupTemplateUrl);var R=function(){A&&H.val("")},W=function(){j.matches=[],j.activeIdx=-1,t.attr("aria-expanded",!1),R()},K=function(e){return B+"-option-"+e};j.$watch("activeIdx",function(e){0>e?t.removeAttr("aria-activedescendant"):t.attr("aria-activedescendant",K(e))});var G=function(e,t){return j.matches.length>t&&e?e.toUpperCase()===j.matches[t].label.toUpperCase():!1},J=function(a,n){var i={$viewValue:a};U(e,!0),M(e,!1),o.when(F.source(e,i)).then(function(o){var r=a===f.$viewValue;if(r&&w)if(o&&o.length>0){j.activeIdx=V?0:-1,M(e,!1),j.matches.length=0;for(var c=0;c<o.length;c++)i[F.itemName]=o[c],j.matches.push({id:K(c),label:F.viewMapper(j,i),model:o[c]});if(j.query=a,v(),t.attr("aria-expanded",!0),k&&1===j.matches.length&&G(a,0)&&(angular.isNumber(j.debounceUpdate)||angular.isObject(j.debounceUpdate)?p(function(){j.select(0,n)},angular.isNumber(j.debounceUpdate)?j.debounceUpdate:j.debounceUpdate["default"]):j.select(0,n)),A){var l=j.matches[0].label;angular.isString(a)&&a.length>0&&l.slice(0,a.length).toUpperCase()===a.toUpperCase()?H.val(a+l.slice(a.length)):H.val("")}}else W(),M(e,!0);r&&U(e,!1)},function(){W(),U(e,!1),M(e,!0)})};S&&(angular.element(l).on("resize",h),c.find("body").on("scroll",h));var Q=p(function(){j.matches.length&&v(),j.moveInProgress=!1},$);j.moveInProgress=!1,j.query=void 0;var X,Y=function(e){X=r(function(){J(e)},y)},Z=function(){X&&r.cancel(X)};W(),j.assignIsOpen=function(t){q(e,t)},j.select=function(n,i){var o,c,l={};I=!0,l[F.itemName]=c=j.matches[n].model,o=F.modelMapper(e,l),C(e,o),f.$setValidity("editable",!0),f.$setValidity("parse",!0),T(e,{$item:c,$model:o,$label:F.viewMapper(e,l),$event:i}),W(),j.$eval(a.typeaheadFocusOnSelect)!==!1&&r(function(){t[0].focus()},0,!1)},t.on("keydown",function(t){if(0!==j.matches.length&&-1!==g.indexOf(t.which)){if(-1===j.activeIdx&&(9===t.which||13===t.which)||9===t.which&&t.shiftKey)return W(),void j.$digest();t.preventDefault();var a;switch(t.which){case 9:case 13:j.$apply(function(){angular.isNumber(j.debounceUpdate)||angular.isObject(j.debounceUpdate)?p(function(){j.select(j.activeIdx,t)},angular.isNumber(j.debounceUpdate)?j.debounceUpdate:j.debounceUpdate["default"]):j.select(j.activeIdx,t)});break;case 27:t.stopPropagation(),W(),e.$digest();break;case 38:j.activeIdx=(j.activeIdx>0?j.activeIdx:j.matches.length)-1,j.$digest(),a=L.find("li")[j.activeIdx],a.parentNode.scrollTop=a.offsetTop;break;case 40:j.activeIdx=(j.activeIdx+1)%j.matches.length,j.$digest(),a=L.find("li")[j.activeIdx],a.parentNode.scrollTop=a.offsetTop}}}),t.bind("focus",function(e){w=!0,0!==b||f.$viewValue||r(function(){J(f.$viewValue,e)},0)}),t.bind("blur",function(e){O&&j.matches.length&&-1!==j.activeIdx&&!I&&(I=!0,j.$apply(function(){angular.isObject(j.debounceUpdate)&&angular.isNumber(j.debounceUpdate.blur)?p(function(){j.select(j.activeIdx,e)},j.debounceUpdate.blur):j.select(j.activeIdx,e)})),!x&&f.$error.editable&&(f.$viewValue="",f.$setValidity("editable",!0),f.$setValidity("parse",!0),t.val("")),w=!1,I=!1});var ee=function(a){t[0]!==a.target&&3!==a.which&&0!==j.matches.length&&(W(),s.$$phase||e.$digest())};c.on("click",ee),e.$on("$destroy",function(){c.off("click",ee),(S||P)&&te.remove(),S&&(angular.element(l).off("resize",h),c.find("body").off("scroll",h)),L.remove(),A&&D.remove()});var te=n(L)(j);S?c.find("body").append(te):P?angular.element(P).eq(0).append(te):t.after(te),this.init=function(t,a){f=t,m=a,j.debounceUpdate=f.$options&&i(f.$options.debounce)(e),f.$parsers.unshift(function(t){return w=!0,0===b||t&&t.length>=b?y>0?(Z(),Y(t)):J(t):(U(e,!1),Z(),W()),x?t:t?void f.$setValidity("editable",!1):(f.$setValidity("editable",!0),null)}),f.$formatters.push(function(t){var a,n,i={};return x||f.$setValidity("editable",!0),N?(i.$model=t,N(e,i)):(i[F.itemName]=t,a=F.viewMapper(e,i),i[F.itemName]=void 0,n=F.viewMapper(e,i),a!==n?a:t)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","^?ngModelOptions","uibTypeahead"],link:function(e,t,a,n){n[2].init(n[0],n[1])}}}).directive("uibTypeaheadPopup",["$$debounce",function(e){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&",assignIsOpen:"&",debounce:"&"},replace:!0,templateUrl:function(e,t){return t.popupTemplateUrl||"uib/template/typeahead/typeahead-popup.html"},link:function(t,a,n){t.templateUrl=n.templateUrl,t.isOpen=function(){var e=t.matches.length>0;return t.assignIsOpen({isOpen:e}),e},t.isActive=function(e){return t.active===e},t.selectActive=function(e){t.active=e},t.selectMatch=function(a,n){var i=t.debounce();angular.isNumber(i)||angular.isObject(i)?e(function(){t.select({activeIdx:a,evt:n})},angular.isNumber(i)?i:i["default"]):t.select({activeIdx:a,evt:n})}}}}]).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(e,t,a){return{scope:{index:"=",match:"=",query:"="},link:function(n,i,o){var r=a(o.templateUrl)(n.$parent)||"uib/template/typeahead/typeahead-match.html";e(r).then(function(e){var a=angular.element(e.trim());i.replaceWith(a),t(a)(n)})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(e,t,a){function n(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function i(e){return/<.*>/g.test(e)}var o;return o=t.has("$sanitize"),function(t,r){return!o&&i(t)&&a.warn("Unsafe use of typeahead please use ngSanitize"),t=r?(""+t).replace(new RegExp(n(r),"gi"),"<strong>$&</strong>"):t,o||(t=e.trustAsHtml(t)),t}}]);
!function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(r){r.decorator("$ocLazyLoad",["$delegate","$q",function(r,n){return r.filesLoader=function(o){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=[],s=[],l=[],a=[],d=null,f=r._getFilesCache();r.toggleWatch(!0),e.extend(t,o);var u=function(n){var o,u=null;if(e.isObject(n)&&(u=n.type,n=n.path),d=f.get(n),e.isUndefined(d)||t.cache===!1){if(null!==(o=/^(css|less|html|htm|js)?(?=!)/.exec(n))&&(u=o[1],n=n.substr(o[1].length+1,n.length)),!u)if(null!==(o=/[.](css|less|html|htm|js)?((\?|#).*)?$/.exec(n)))u=o[1];else{if(r.jsLoader.hasOwnProperty("ocLazyLoadLoader")||!r.jsLoader.hasOwnProperty("requirejs"))return void r._$log.error("File type could not be determined. "+n);u="js"}"css"!==u&&"less"!==u||-1!==i.indexOf(n)?"html"!==u&&"htm"!==u||-1!==s.indexOf(n)?"js"===u||-1===l.indexOf(n)?l.push(n):r._$log.error("File type is not valid. "+n):s.push(n):i.push(n)}else d&&a.push(d)};if(t.serie?u(t.files.shift()):e.forEach(t.files,function(e){u(e)}),i.length>0){var c=n.defer();r.cssLoader(i,function(n){e.isDefined(n)&&r.cssLoader.hasOwnProperty("ocLazyLoadLoader")?(r._$log.error(n),c.reject(n)):c.resolve()},t),a.push(c.promise)}if(s.length>0){var h=n.defer();r.templatesLoader(s,function(n){e.isDefined(n)&&r.templatesLoader.hasOwnProperty("ocLazyLoadLoader")?(r._$log.error(n),h.reject(n)):h.resolve()},t),a.push(h.promise)}if(l.length>0){var g=n.defer();r.jsLoader(l,function(n){e.isDefined(n)&&(r.jsLoader.hasOwnProperty("ocLazyLoadLoader")||r.jsLoader.hasOwnProperty("requirejs"))?(r._$log.error(n),g.reject(n)):g.resolve()},t),a.push(g.promise)}if(0===a.length){var p=n.defer(),m="Error: no file to load has been found, if you're trying to load an existing module you should use the 'inject' method instead of 'load'.";return r._$log.error(m),p.reject(m),p.promise}return t.serie&&t.files.length>0?n.all(a).then(function(){return r.filesLoader(o,t)}):n.all(a)["finally"](function(e){return r.toggleWatch(!1),e})},r.load=function(o){var t,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=this,l=null,a=[],d=n.defer(),f=e.copy(o),u=e.copy(i);if(e.isArray(f))return e.forEach(f,function(e){a.push(s.load(e,u))}),n.all(a).then(function(e){d.resolve(e)},function(e){d.reject(e)}),d.promise;if(e.isString(f)?(l=s.getModuleConfig(f),l||(l={files:[f]})):e.isObject(f)&&(l=e.isDefined(f.path)&&e.isDefined(f.type)?{files:[f]}:s.setModuleConfig(f)),null===l){var c=s._getModuleName(f);return t='Module "'+(c||"unknown")+'" is not configured, cannot load.',r._$log.error(t),d.reject(new Error(t)),d.promise}e.isDefined(l.template)&&(e.isUndefined(l.files)&&(l.files=[]),e.isString(l.template)?l.files.push(l.template):e.isArray(l.template)&&l.files.concat(l.template));var h=e.extend({},u,l);return e.isUndefined(l.files)&&e.isDefined(l.name)&&r.moduleExists(l.name)?r.inject(l.name,h,!0):(r.filesLoader(l,h).then(function(){r.inject(null,h).then(function(e){d.resolve(e)},function(e){d.reject(e)})},function(e){d.reject(e)}),d.promise)},r}])}])}(angular);